displayName: TypeScript SDK
irVersion: v61
image: fernapi/fern-typescript-sdk
imageAliases: [fernapi/fern-typescript-node-sdk]
changelogLocation: ../../generators/typescript/sdk/versions.yml
publish:
  preBuildCommands:
    - pnpm --filter @fern-typescript/sdk-generator-cli dist:cli
  docker:
    file: ./generators/typescript/sdk/cli/Dockerfile
    image: fernapi/fern-typescript-sdk
    aliases: [fernapi/fern-typescript-node-sdk]
    context: .
test:
  docker:
    image: fernapi/fern-typescript-sdk:latest
    command:
      - pnpm --filter @fern-typescript/sdk-generator-cli dockerTagLatest
  local:
    workingDirectory: generators/typescript
    buildCommand:
      - pnpm --filter @fern-typescript/sdk-generator-cli dist:cli
    runCommand: node --enable-source-maps sdk/cli/dist/cli.cjs {CONFIG_PATH}
    env:
      NODE_ENV: test

language: typescript
generatorType: SDK
defaultOutputMode: github

customFixtureConfig:
  customConfig: {}
fixtures:
  imdb:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: omit-undefined
      customConfig:
        omitUndefined: true
    - outputFolder: branded-string-aliases
      customConfig:
        useBrandedStringAliases: true
  streaming:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: serde-layer
      customConfig:
        noSerdeLayer: false
    - outputFolder: wrapper
      customConfig:
        streamType: wrapper
        testFramework: jest
  audiences:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: with-partner-audience
      customConfig: null
      audiences:
        - partner
  exhaustive:
    - outputFolder: use-jest
      customConfig:
        testFramework: jest
    - outputFolder: package-path
      customConfig:
        packagePath: src/test-packagePath
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: with-audiences
      customConfig: null
      audiences:
        - audience1
        - audience2
    - outputFolder: serde-layer
      customConfig:
        noSerdeLayer: false
    - outputFolder: retain-original-casing
      customConfig:
        retainOriginalCasing: true
    - outputFolder: allow-extra-fields
      customConfig:
        allowExtraFields: true
    - outputFolder: bigint
      customConfig:
        useBigInt: true
        testFramework: jest
    - outputFolder: bigint-serde-layer
      customConfig:
        useBigInt: true
        noSerdeLayer: false
        testFramework: jest
    - outputFolder: web-stream-wrapper
      customConfig:
        streamType: web
    - outputFolder: node-fetch
      customConfig:
        fetchSupport: node-fetch
    - outputFolder: local-files
      outputMode: local_files
    - outputFolder: local-files-no-source
      outputMode: local_files
      customConfig:
        outputSourceFiles: false
    - outputFolder: never-throw-errors
      customConfig:
        neverThrowErrors: true
    - outputFolder: export-all-requests-at-root
      customConfig:
        exportAllRequestsAtRoot: true
    - outputFolder: consolidate-type-files
      customConfig:
        consolidateTypeFiles: true
    - outputFolder: parameter-naming-original-name
      customConfig:
        parameterNaming: originalName
    - outputFolder: parameter-naming-wire-value
      customConfig:
        parameterNaming: wireValue
    - outputFolder: parameter-naming-camel-case
      customConfig:
        parameterNaming: camelCase
    - outputFolder: parameter-naming-snake-case
      customConfig:
        parameterNaming: snakeCase
  error-property:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: union-utils
      customConfig:
        includeUtilsOnUnionMembers: true
        includeOtherInUnionTypes: true
  undiscriminated-unions:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: skip-response-validation
      customConfig:
        skipResponseValidation: true
  file-download:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: file-download-response-headers
      customConfig:
        includeContentHeadersOnFileDownloadResponse: true
    - outputFolder: stream-wrapper
      customConfig:
        fileResponseType: 'stream'
        streamType: wrapper
        testFramework: jest
  file-upload:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: inline
      customConfig:
        inlineFileProperties: true
        inlinePathParameters: true
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
    - outputFolder: wrapper
      customConfig:
        streamType: wrapper
        testFramework: jest
    - outputFolder: form-data-node16
      customConfig:
        formDataSupport: 'Node16'
    - outputFolder: use-jest
      customConfig:
        testFramework: jest
  unknown:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: unknown-as-any
      customConfig:
        treatUnknownAsAny: true
  query-parameters:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
    - outputFolder: parameter-naming-original-name
      customConfig:
        parameterNaming: originalName
    - outputFolder: parameter-naming-wire-value
      customConfig:
        parameterNaming: wireValue
    - outputFolder: parameter-naming-camel-case
      customConfig:
        parameterNaming: camelCase
    - outputFolder: parameter-naming-snake-case
      customConfig:
        parameterNaming: snakeCase
  request-parameters:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: use-default-request-parameter-values
      customConfig:
        useDefaultRequestParameterValues: true
    - outputFolder: use-big-int-and-default-request-parameter-values
      customConfig:
        useDefaultRequestParameterValues: true
        useBigInt: true
        testFramework: jest
    - outputFolder: flatten-request-parameters
      customConfig:
        flattenRequestParameters: true
  trace:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
    - outputFolder: serde-no-throwing
      customConfig:
        noSerdeLayer: false
        neverThrowErrors: true
    - outputFolder: exhaustive
      customConfig:
        useBrandedStringAliases: true
        neverThrowErrors: true
        includeCredentialsOnCrossOriginRequests: true
        includeUtilsOnUnionMembers: true
        includeOtherInUnionTypes: true
        timeoutInSeconds: 'infinity'
  examples:
    - outputFolder: examples-with-api-reference
      customConfig:
        includeApiReference: true
        customReadmeSections:
          - title: "Override Section"
            content: "Override Content"
          - title: "Generator Invocation Custom Section"
            content: "Generator Invocation Custom Content for {{ packageName }}"
      readmeConfig:
        apiName: "CustomName"
        disabledSections:
          - "contributing"
        bannerLink: https://www.fernapi.com
        apiReferenceLink: https://www.docs.fernapi.com
        defaultEndpoint: POST /movie
        customSections:
          - title: "Base Readme Custom Section"
            language: typescript
            content: "Base Readme Custom Content for {{ packageName }}"
          - title: "Override Section"
            language: typescript
            content: "Base Content"
        features:
          timeouts:
            - GET /movie/{movieId}
            - method: POST
              path: /movie
    - outputFolder: retain-original-casing
      customConfig:
        retainOriginalCasing: true
  oauth-client-credentials:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
  oauth-client-credentials-nested-root:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: never-throw-errors
      customConfig:
        neverThrowErrors: true
  mixed-case:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: retain-original-casing
      customConfig:
        retainOriginalCasing: true
  ts-inline-types:
    - outputFolder: inline
      customConfig:
        enableInlineTypes: true
    - outputFolder: no-inline
      customConfig:
        enableInlineTypes: false
  path-parameters:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: retain-original-casing
      customConfig:
        retainOriginalCasing: true
    - outputFolder: inline-path-parameters
      customConfig:
        inlinePathParameters: true
    - outputFolder: inline-path-parameters-serde
      customConfig:
        inlinePathParameters: true
        noSerdeLayer: false
    - outputFolder: inline-path-parameters-retain-original-casing
      customConfig:
        inlinePathParameters: true
        retainOriginalCasing: true
    - outputFolder: inline-path-parameters-always
      customConfig:
        inlinePathParameters: "always"
    - outputFolder: parameter-naming-original-name
      customConfig:
        parameterNaming: originalName
    - outputFolder: parameter-naming-wire-value
      customConfig:
        parameterNaming: wireValue
    - outputFolder: parameter-naming-camel-case
      customConfig:
        parameterNaming: camelCase
    - outputFolder: parameter-naming-snake-case
      customConfig:
        parameterNaming: snakeCase
  websocket:
    - outputFolder: no-websocket-clients
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
        shouldGenerateWebsocketClients: true
    - outputFolder: no-serde
      customConfig:
        noSerdeLayer: true
        shouldGenerateWebsocketClients: true
  property-access:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: generate-read-write-only-types
      customConfig:
        experimentalGenerateReadWriteOnlyTypes: true
  websocket-bearer-auth:
    - outputFolder: websockets
      customConfig:
        shouldGenerateWebsocketClients: true
  websocket-inferred-auth:
    - outputFolder: websockets
      customConfig:
        shouldGenerateWebsocketClients: true
  any-auth:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: generate-endpoint-metadata
      customConfig:
        generateEndpointMetadata: true
  simple-api:
    - outputFolder: use-yarn
      customConfig:
        packageManager: yarn
    - outputFolder: use-prettier
      customConfig:
        formatter: prettier
    - outputFolder: use-oxfmt
      customConfig:
        formatter: oxfmt
    - outputFolder: use-prettier-no-linter
      customConfig:
        formatter: prettier
        linter: none
    - outputFolder: use-oxlint
      customConfig:
        linter: oxlint
    - outputFolder: no-linter
      customConfig:
        linter: none
    - outputFolder: omit-fern-headers
      customConfig:
        omitFernHeaders: true
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: bundle
      customConfig:
        bundle: true
        extraDependencies:
          lodash-es: '^4.17.21'
    - outputFolder: custom-package-json
      customConfig:
        private: true
        extraDependencies:
          lodash-es: '^4.17.21'
        extraDevDependencies:
          jest: '^29.7.0'
        extraPeerDependencies:
          'openai': '^4.47.1'
        extraPeerDependenciesMeta:
          'openai':
            optional: true
        packageJson:
          version: '0.0.2'
          dependencies:
            stream: '^0.0.2'
            qs: '^6.11.2'
          files:
            - exampleFile
            - dist
          browser:
            command-exists: false
            execa: false
          engines:
            node: '>=16.0.0'
    - outputFolder: allow-extra-fields
      customConfig:
        allowExtraFields: true
    - outputFolder: jsr
      customConfig:
        publishToJsr: true
    - outputFolder: legacy-exports
      customConfig:
        useLegacyExports: true
    - outputFolder: oidc-token
      publishConfig:
        type: npm     
        registryUrl: https://registry.npmjs.org/
        packageName: "@fern-api/dummy"
        token: <USE_OIDC>
    - outputFolder: no-scripts
      customConfig:
        noScripts: true
    - outputFolder: allow-custom-fetcher
      customConfig:
        allowCustomFetcher: true
  enum:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: forward-compatible-enums
      customConfig:
        enableForwardCompatibleEnums: true
    - outputFolder: serde
      customConfig:
        noSerdeLayer: false
scripts:
  - docker: fernapi/ts-seed
    commands:
      - |
        if [ ! -f "package.json" ]; then
          echo "No package.json found, exiting..."
          exit 0
        fi
        if grep -q '"packageManager": "pnpm' package.json; then
          mkdir -p .pnpm-cache
          echo "Preparing corepack and pnpm..."
          corepack prepare pnpm --activate
          echo "Running pnpm install..."
          if [ -f "pnpm-lock.yaml" ]; then
            corepack pnpm install --prefer-offline --frozen-lockfile
          else
            corepack pnpm install --prefer-offline
          fi
          echo "Running pnpm build..."
          if grep -q '"build":' package.json; then corepack pnpm build; fi
          echo "Running pnpm test..."
          if grep -q '"test":' package.json; then corepack pnpm test; fi
        fi
        if grep -q '"packageManager": "yarn' package.json; then
          mkdir -p .yarn-cache
          echo "Preparing corepack and yarn..."
          corepack prepare yarn --activate
          echo "Running yarn install..."
          if [ -f "yarn.lock" ]; then
            corepack yarn install --prefer-offline --frozen-lockfile
          else
            corepack yarn install --prefer-offline
          fi
          echo "Running yarn build..."
          if grep -q '"build":' package.json; then corepack yarn build; fi
          echo "Running yarn test..."
          if grep -q '"test":' package.json; then corepack yarn test; fi
        fi
allowedFailures:
  - enum:no-custom-config
  - enum:forward-compatible-enums
  - enum:serde
  - error-property:no-custom-config
  - error-property:union-utils
  - errors
  - oauth-client-credentials-custom
  - package-yml
  - trace:no-custom-config
  - trace:serde
