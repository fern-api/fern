// This file was auto-generated by Fern from our API Definition.

import * as core from "../core/index.js";

export namespace BasicAuthProvider {
    export interface Options {
        username: core.Supplier<string>;
        password: core.Supplier<string>;
    }
}

export class BasicAuthProvider implements core.AuthProvider {
    private readonly username: core.Supplier<string>;
    private readonly password: core.Supplier<string>;

    constructor(options: BasicAuthProvider.Options) {
        this.username = options.username;
        this.password = options.password;
    }

    public async getAuthRequest(): Promise<core.AuthRequest> {
        const username = await core.Supplier.get(this.username);
        if (username == null) {
            throw new Error("Please specify a username by passing it in to the constructor");
        }

        const password = await core.Supplier.get(this.password);
        if (password == null) {
            throw new Error("Please specify a password by passing it in to the constructor");
        }

        const authHeader = core.BasicAuth.toAuthorizationHeader({
            username: username,
            password: password,
        });

        return {
            headers: authHeader != null ? { Authorization: authHeader } : {},
        };
    }
}
