// This file was auto-generated by Fern from our API Definition.

import * as core from "../core/index.js";

export namespace BasicAuthProvider {
    export interface Options {
        username?: core.Supplier<string | undefined>;
        accessToken?: core.Supplier<string | undefined>;
    }
}

export class BasicAuthProvider implements core.AuthProvider {
    private readonly username: core.Supplier<string | undefined> | undefined;
    private readonly password: core.Supplier<string | undefined> | undefined;

    constructor(options: BasicAuthProvider.Options) {
        this.username = options.username;
        this.password = options.accessToken;
    }

    public async getAuthRequest(): Promise<core.AuthRequest> {
        const username = (await core.Supplier.get(this.username)) ?? process.env?.USERNAME;
        if (username == null) {
            throw new Error(
                "Please specify a username by either passing it in to the constructor or initializing a USERNAME environment variable",
            );
        }

        const accessToken = (await core.Supplier.get(this.password)) ?? process.env?.PASSWORD;
        if (accessToken == null) {
            throw new Error(
                "Please specify a accessToken by either passing it in to the constructor or initializing a PASSWORD environment variable",
            );
        }

        const authHeader = core.BasicAuth.toAuthorizationHeader({
            username: username,
            password: accessToken,
        });

        return {
            headers: authHeader != null ? { Authorization: authHeader } : {},
        };
    }
}
