// This file was auto-generated by Fern from our API Definition.

import type { BaseClientOptions } from "../BaseClient.js";
import * as core from "../core/index.js";
import { BearerAuthProvider } from "./BearerAuthProvider.js";
import { HeaderAuthProvider } from "./HeaderAuthProvider.js";
import { OAuthAuthProvider } from "./OAuthAuthProvider.js";

export namespace AnyAuthProvider {
    export type AuthOptions = {
        auth:
            | ({ type: "Bearer" } & BearerAuthProvider.AuthOptions)
            | ({ type: "ApiKey" } & HeaderAuthProvider.AuthOptions)
            | ({ type: "OAuth" } & OAuthAuthProvider.AuthOptions);
    };
}

export class AnyAuthProvider implements core.AuthProvider {
    private readonly delegate: core.AuthProvider;

    constructor(options: BaseClientOptions) {
        if (options.auth == null) {
            this.delegate = new core.NoOpAuthProvider();
            return;
        }
        switch (options.auth.type) {
            case "Bearer":
                this.delegate = new BearerAuthProvider({ ...options, ...options.auth });
                break;
            case "ApiKey":
                this.delegate = new HeaderAuthProvider({ ...options, ...options.auth });
                break;
            case "OAuth":
                this.delegate = new OAuthAuthProvider({ ...options, ...options.auth });
                break;
            default: {
                const _exhaustive: never = options.auth;
                throw new Error("Unknown auth type");
            }
        }
    }

    public async getAuthRequest(arg?: { endpointMetadata?: core.EndpointMetadata }): Promise<core.AuthRequest> {
        return this.delegate.getAuthRequest(arg);
    }
}
