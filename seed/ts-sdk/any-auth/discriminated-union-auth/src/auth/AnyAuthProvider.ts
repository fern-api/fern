// This file was auto-generated by Fern from our API Definition.

import type * as core from "../core/index.js";

export namespace AnyAuthProvider {
    export type AuthOptions = {
        auth?:
            | {
                  type: "Bearer";
                  token?: core.BearerToken | (() => core.BearerToken) | (() => Promise<core.BearerToken>);
              }
            | { type: "ApiKey"; apiKey?: string | (() => string) | (() => Promise<string>) }
            | { type: "OAuth"; clientId?: string; clientSecret?: string };
    };
}

export class AnyAuthProvider implements core.AuthProvider {
    private readonly auth: AnyAuthProvider.AuthOptions["auth"];

    constructor(auth: AnyAuthProvider.AuthOptions["auth"]) {
        this.auth = auth;
    }

    public async getAuthRequest(_arg?: { endpointMetadata?: core.EndpointMetadata }): Promise<core.AuthRequest> {
        if (this.auth == null) {
            return { headers: {} };
        }

        switch (this.auth.type) {
            case "Bearer": {
                const tokenValue = this.auth.token;
                const token =
                    typeof tokenValue === "function" ? await tokenValue() : (tokenValue ?? process.env?.MY_TOKEN);
                if (token != null) {
                    return { headers: { Authorization: `Bearer ${token}` } };
                }
                break;
            }

            case "ApiKey": {
                const headerValue = this.auth.apiKey;
                const header =
                    typeof headerValue === "function" ? await headerValue() : (headerValue ?? process.env?.MY_API_KEY);
                if (header != null) {
                    return { headers: { "X-API-Key": header } };
                }
                break;
            }

            case "OAuth": {
                // OAuth client credentials - token should be obtained via the token endpoint
                // This is a placeholder - actual OAuth implementation requires token management
                throw new Error(
                    "OAuth authentication requires token management. Please use the OAuth token endpoint to obtain a token.",
                );
            }
            default:
                return { headers: {} };
        }

        return { headers: {} };
    }
}
