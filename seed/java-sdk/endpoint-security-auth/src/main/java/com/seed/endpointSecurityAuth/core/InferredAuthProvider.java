/**
 * This file was auto-generated by Fern from our API Definition.
 */
package com.seed.endpointSecurityAuth.core;

import java.util.Map;

/**
 * Auth provider for inferred authentication (InferredAuth).
 * Uses a token supplier to fetch and cache auth headers from the token endpoint.
 */
public final class InferredAuthProvider implements AuthProvider {
    public static final String AUTH_SCHEME = "InferredAuth";

    public static final String AUTH_CONFIG_ERROR_MESSAGE =
            "Please provide the required credentials for InferredAuth when initializing the client";

    private final InferredAuthTokenSupplier tokenSupplier;

    public InferredAuthProvider(InferredAuthTokenSupplier tokenSupplier) {
        this.tokenSupplier = tokenSupplier;
    }

    @Override
    public Map<String, String> getAuthHeaders(EndpointMetadata endpointMetadata) {
        // The token supplier returns a map of headers from the token endpoint
        return tokenSupplier.get();
    }
}
