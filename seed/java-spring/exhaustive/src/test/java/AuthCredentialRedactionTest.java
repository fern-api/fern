/**
 * This file was auto-generated by Fern from our API Definition.
 */

import static org.junit.jupiter.api.Assertions.*;

import core.BearerAuth;
import java.lang.String;
import org.junit.jupiter.api.Test;

/**
 * Security test to verify toString() methods don't leak credentials in logs and debuggers.
 */
public final class AuthCredentialRedactionTest {
  @Test
  public void testBearerAuthToStringDoesNotExposeToken() {
    String sensitiveToken = "sk_live_secret_key_12345";
    BearerAuth auth = BearerAuth.of(sensitiveToken);

    String toStringResult = auth.toString();

    assertEquals("BearerAuth{token=[REDACTED]}", toStringResult);
    assertFalse(toStringResult.contains(sensitiveToken));
    assertFalse(toStringResult.contains("sk_live"));
    assertFalse(toStringResult.contains("secret_key"));
  }

  @Test
  public void testBearerAuthGetTokenStillWorks() {
    String sensitiveToken = "sk_live_secret_key_12345";
    BearerAuth auth = BearerAuth.of(sensitiveToken);

    assertEquals(sensitiveToken, auth.getToken());
  }

  @Test
  public void testToStringInLoggingScenario() {
    BearerAuth auth = BearerAuth.of("secret_api_key");

    String logFormat = String.format("Request with auth: %s", auth);
    String logConcat = "Request with auth: " + auth;

    assertTrue(logFormat.contains("[REDACTED]"));
    assertTrue(logConcat.contains("[REDACTED]"));
    assertFalse(logFormat.contains("secret_api_key"));
    assertFalse(logConcat.contains("secret_api_key"));
  }

  @Test
  public void testMultipleBearerAuthInstancesAllRedacted() {
    BearerAuth auth1 = BearerAuth.of("token1");
    BearerAuth auth2 = BearerAuth.of("token2");
    BearerAuth auth3 = BearerAuth.of("token3");

    assertEquals("BearerAuth{token=[REDACTED]}", auth1.toString());
    assertEquals("BearerAuth{token=[REDACTED]}", auth2.toString());
    assertEquals("BearerAuth{token=[REDACTED]}", auth3.toString());

    assertEquals("token1", auth1.getToken());
    assertEquals("token2", auth2.getToken());
    assertEquals("token3", auth3.getToken());
  }
}
