irVersion: v58
displayName: Java Spring
changelogLocation: ../../generators/java/spring/versions.yml
image: fernapi/fern-java-spring
publish:
  workingDirectory: generators/java
  preBuildCommands:
    - ./gradlew :spring:distTar
  docker:
    file: ./generators/java/spring/Dockerfile
    image: fernapi/fern-java-spring
    context: ./generators/java/spring
test:
  docker:
    image: fernapi/fern-java-spring:latest
    context: .
    command:
      - cd generators/java
      - ./gradlew :spring:distTar
      - docker build -f spring/Dockerfile -t fernapi/fern-java-spring:latest spring/
  local:
    workingDirectory: generators/java
    buildCommand:
      - ./gradlew :spring:distTar
      - chmod +x install-gradle.sh && ./install-gradle.sh
      - cd spring
      - tar -xvf build/distributions/spring.tar -C .
    runCommand: cd spring/spring && java -cp spring.jar:lib/* com.fern.java.spring.Cli {CONFIG_PATH}
    env: {}
fixtures:
  imdb:
    - customConfig:
        enable-public-constructors: true
      outputFolder: enable-public-constructors
    - customConfig:
        disable-required-property-builder-checks: true
      outputFolder: disable-required-property-builder-checks
  content-type:
    - customConfig:
        package-prefix: com.random.api.generated
      outputFolder: package-prefix
  nullable-optional:
    - customConfig:
        use-nullable-annotation: true
      outputFolder: with-nullable-annotation
    - customConfig:
        use-nullable-annotation: false
      outputFolder: legacy
language: java
generatorType: Server
defaultOutputMode: local_files
allowedFailures:
  - file-download
  - file-upload
  - file-upload-openapi
  - plain-text
  - response-property
  - streaming
  - server-sent-events
  - server-sent-event-examples
  - alias-extends
  - any-auth
  - streaming-parameter
  # public-object requires file download
  - public-object

  - bytes-download
  - bytes-upload
  - multiple-request-bodies
  - undiscriminated-union-with-response-property
  - enum