/**
 * This file was auto-generated by Fern from our API Definition.
 */

import static org.junit.jupiter.api.Assertions.*;

import core.BasicAuth;
import java.lang.String;
import org.junit.jupiter.api.Test;

/**
 * Security test to verify toString() methods don't leak credentials in logs and debuggers.
 */
public final class AuthCredentialRedactionTest {
  @Test
  public void testBasicAuthToStringDoesNotExposeCredentials() {
    String username = "admin";
    String password = "super_secret_password_123";
    BasicAuth auth = BasicAuth.of(username, password);

    String toStringResult = auth.toString();

    assertEquals("BasicAuth{credentials=[REDACTED]}", toStringResult);
    assertFalse(toStringResult.contains(username));
    assertFalse(toStringResult.contains(password));
    assertFalse(toStringResult.contains("admin"));
    assertFalse(toStringResult.contains("super_secret"));
  }

  @Test
  public void testBasicAuthAccessorsStillWork() {
    String username = "admin";
    String password = "super_secret_password_123";
    BasicAuth auth = BasicAuth.of(username, password);

    assertEquals(username, auth.username());
    assertEquals(password, auth.password());

    assertNotNull(auth.getToken());
    assertFalse(auth.getToken().isEmpty());
  }

  @Test
  public void testMultipleBasicAuthInstancesAllRedacted() {
    BasicAuth auth1 = BasicAuth.of("user1", "pass1");
    BasicAuth auth2 = BasicAuth.of("user2", "pass2");

    assertEquals("BasicAuth{credentials=[REDACTED]}", auth1.toString());
    assertEquals("BasicAuth{credentials=[REDACTED]}", auth2.toString());

    assertEquals("user1", auth1.username());
    assertEquals("user2", auth2.username());
  }

  @Test
  public void testPasswordWithSpecialCharacters() {
    String password = "p@$$w0rd!#$%^&*()";
    BasicAuth auth = BasicAuth.of("user", password);

    String toStringResult = auth.toString();
    assertEquals("BasicAuth{credentials=[REDACTED]}", toStringResult);
    assertFalse(toStringResult.contains(password));
    assertFalse(toStringResult.contains("@$$w0rd"));

    assertEquals(password, auth.password());
  }
}
