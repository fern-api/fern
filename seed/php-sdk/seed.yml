irVersion: v61
displayName: PHP SDK
image: fernapi/fern-php-sdk
changelogLocation: ../../generators/php/sdk/versions.yml
publish:
  preBuildCommands:
    - pnpm --filter @fern-api/php-sdk dist:cli
  docker:
    file: ./generators/php/sdk/Dockerfile
    image: fernapi/fern-php-sdk
    context: .
test:
  docker:
    image: fernapi/fern-php-sdk:latest
    command: pnpm --filter @fern-api/php-sdk dockerTagLatest
  podman:
    image: fernapi/fern-php-sdk:latest
    command: pnpm --filter @fern-api/php-sdk podmanTagLatest
  local:
    workingDirectory: generators/php
    buildCommand:
      - pnpm --filter @fern-api/php-sdk dist:cli
    runCommand: node --enable-source-maps sdk/dist/cli.cjs {CONFIG_PATH}
language: php
generatorType: SDK
defaultOutputMode: github
fixtures:
  examples:
    - customConfig: null
      outputFolder: no-custom-config
    - customConfig:
        customReadmeSections:
          - title: "Override Section"
            content: "Override Content"
          - title: "Generator Invocation Custom Section"
            content: "Generator Invocation Custom Content for {{ packageName }}"
      readmeConfig:
        apiName: "CustomName"
        disabledSections:
          - "contributing"
        bannerLink: https://www.fernapi.com
        apiReferenceLink: https://www.docs.fernapi.com
        defaultEndpoint: POST /movie
        customSections:
          - title: "Base Readme Custom Section"
            language: php
            content: "Base Readme Custom Content for {{ packageName }}"
          - title: "Override Section"
            language: php
            content: "Base Content"
        features:
          timeouts:
            - GET /movie/{movieId}
            - method: POST
              path: /movie
      outputFolder: readme-config
  extends:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: private
      customConfig:
        propertyAccess: private
  imdb:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: clientName
      customConfig:
        clientName: FernClient
    - outputFolder: packageName
      customConfig:
        packageName: fern-api/imdb-php
    - outputFolder: namespace
      customConfig:
        namespace: Fern
    - outputFolder: private
      customConfig:
        propertyAccess: private
    - outputFolder: package-path
      customConfig:
        packagePath: Custom/Package/Path
        namespace: Custom\Package\Path
  package-yml:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: private
      customConfig:
        propertyAccess: private
  path-parameters:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: inline-path-parameters
      customConfig:
        inlinePathParameters: true
    - outputFolder: inline-path-parameters-private
      customConfig:
        inlinePathParameters: true
        propertyAccess: private
  query-parameters:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: private
      customConfig:
        propertyAccess: private
  pagination:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: property-accessors
      customConfig:
        propertyAccess: private
  unions:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: property-accessors
      customConfig:
        propertyAccess: private
  alias:
    - outputFolder: no-custom-config
      customConfig: null
    - outputFolder: composer-json
      customConfig:
        composerJson:
          name: fern/empty
          version: 1.0.0
          description: My Empty PHP Library
          keywords:
          - empty
          license:
          - "LGPL-2.1-only"
          - "GPL-3.0-or-later"
          require:
            guzzlehttp/guzzle: "7.9.2"
            guzzlehttp/promises: "2.0.4"
          require-dev:
            phpunit/phpunit: "12.0.2"
            phpunit/php-timer: "8.0.0"
          scripts:
            build:
            - "@php -l src"
            - "@php -l tests"
            analyze: echo skip
            hello: echo hello
scripts:
  - image: composer:2.7.9
    commands:
      - composer install
      - composer build
      - composer analyze
      - composer test
allowedFailures:
  - pagination-custom
  # Dynamic snippets need to add support for global headers included in the client constructor.
  - header-auth-environment-variable
  # TODO: Add support for bytes upload.
  - bytes-upload
  # Basic auth is not supported yet.
  - basic-auth
  # Generating a union called "Exception" makes our references to Exception throws be escaped incorrectly
  - examples:no-custom-config
  - examples:readme-config
  # Enums don't support the fromJson method yet.
  - exhaustive
  - trace
  - circular-references
  - circular-references-advanced
  # Add support for literals and confirm that string literal examples are being generated.
  - literal
  # Add support for OAuth.
  - oauth-client-credentials
  - oauth-client-credentials-custom
  - oauth-client-credentials-default
  - oauth-client-credentials-environment-variables
  - oauth-client-credentials-nested-root
  # Pagination example values come through as floats instead of integers (e.g. 1.1 instead of 1).
  - pagination:no-custom-config
  - pagination:property-accessors
  # Fix union dynamic snippets (i.e. BigUnion).
  - unions:no-custom-config
  - unions:property-accessors
  # Java-specific fixture for LocalDate support
  - unions-with-local-date
  # unknown
  - file-upload
  - http-head
  - oauth-client-credentials-with-variables
  - variables
  # Java-specific fixture for staged builder ordering
  - java-staged-builder-ordering

