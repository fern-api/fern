// Code generated by Fern. DO NOT EDIT.

package internal

import (
	"net/http"
	"sync"
	"time"
)

type InferredAuthProvider struct {
	ClientId     string
	ClientSecret string
	Audience     string
	GrantType    string
	Scope        string
}

func NewInferredAuthProvider(
	clientId string,
	clientSecret string,
	audience string,
	grantType string,
	scope string,
) *InferredAuthProvider {
	return &InferredAuthProvider{
		ClientId:     clientId,
		ClientSecret: clientSecret,
		Audience:     audience,
		GrantType:    grantType,
		Scope:        scope,
	}
}
func (p *InferredAuthProvider) GetOrFetch(tokenFetcher func() (string, error)) (http.Header, error) {
	token, err := tokenFetcher()
	if err != nil {
		return nil, err
	}

	headers := make(http.Header)
	headers.Set("Authorization", "Bearer "+token)
	return headers, nil
}
