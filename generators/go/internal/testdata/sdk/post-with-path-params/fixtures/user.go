// This file was auto-generated by Fern from our API Definition.

package api

import (
	json "encoding/json"
	fmt "fmt"
	core "github.com/fern-api/fern-go/internal/testdata/sdk/post-with-path-params/fixtures/core"
	time "time"
)

type SetNameRequest struct {
	UserName string    `json:"userName" url:"-"`
	Date     time.Time `json:"date" url:"-" format:"date"`
	Datetime time.Time `json:"datetime" url:"-"`
}

func (s *SetNameRequest) UnmarshalJSON(data []byte) error {
	type unmarshaler SetNameRequest
	var body unmarshaler
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	*s = SetNameRequest(body)
	return nil
}

func (s *SetNameRequest) MarshalJSON() ([]byte, error) {
	type embed SetNameRequest
	var marshaler = struct {
		embed
		Date     *core.Date     `json:"date"`
		Datetime *core.DateTime `json:"datetime"`
	}{
		embed:    embed(*s),
		Date:     core.NewDate(s.Date),
		Datetime: core.NewDateTime(s.Datetime),
	}
	return json.Marshal(marshaler)
}

type SetNameRequestV3 struct {
	XEndpointHeader string                `json:"-" url:"-"`
	Body            *SetNameRequestV3Body `json:"-" url:"-"`
}

func (s *SetNameRequestV3) UnmarshalJSON(data []byte) error {
	body := new(SetNameRequestV3Body)
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	s.Body = body
	return nil
}

func (s *SetNameRequestV3) MarshalJSON() ([]byte, error) {
	return json.Marshal(s.Body)
}

type SetNameRequestV3Optional struct {
	XEndpointHeader string                `json:"-" url:"-"`
	Body            *SetNameRequestV3Body `json:"-" url:"-"`
}

func (s *SetNameRequestV3Optional) UnmarshalJSON(data []byte) error {
	body := new(SetNameRequestV3Body)
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	s.Body = body
	return nil
}

func (s *SetNameRequestV3Optional) MarshalJSON() ([]byte, error) {
	return json.Marshal(s.Body)
}

type SetNameRequestV4 struct {
	XEndpointHeader string   `json:"-" url:"-"`
	Body            []string `json:"-" url:"-"`
}

func (s *SetNameRequestV4) UnmarshalJSON(data []byte) error {
	var body []string
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	s.Body = body
	return nil
}

func (s *SetNameRequestV4) MarshalJSON() ([]byte, error) {
	return json.Marshal(s.Body)
}

type SetNameRequestV5 struct {
	XEndpointHeader string `json:"-" url:"-"`
	Body            string `json:"-" url:"-"`
}

func (s *SetNameRequestV5) UnmarshalJSON(data []byte) error {
	var body string
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	if body != "fern" {
		return fmt.Errorf("expected literal %q, but found %q", "fern", body)
	}
	s.Body = body
	return nil
}

func (s *SetNameRequestV5) MarshalJSON() ([]byte, error) {
	return json.Marshal("fern")
}

type Filter struct {
	Tag string `json:"tag" url:"tag"`

	extraProperties map[string]interface{}
	_rawJSON        json.RawMessage
}

func (f *Filter) GetExtraProperties() map[string]interface{} {
	return f.extraProperties
}

func (f *Filter) UnmarshalJSON(data []byte) error {
	type unmarshaler Filter
	var value unmarshaler
	if err := json.Unmarshal(data, &value); err != nil {
		return err
	}
	*f = Filter(value)

	extraProperties, err := core.ExtractExtraProperties(data, *f)
	if err != nil {
		return err
	}
	f.extraProperties = extraProperties

	f._rawJSON = json.RawMessage(data)
	return nil
}

func (f *Filter) String() string {
	if len(f._rawJSON) > 0 {
		if value, err := core.StringifyJSON(f._rawJSON); err == nil {
			return value
		}
	}
	if value, err := core.StringifyJSON(f); err == nil {
		return value
	}
	return fmt.Sprintf("%#v", f)
}

type SetNameRequestV3Body struct {
	UserName string `json:"userName" url:"userName"`

	extraProperties map[string]interface{}
	_rawJSON        json.RawMessage
}

func (s *SetNameRequestV3Body) GetExtraProperties() map[string]interface{} {
	return s.extraProperties
}

func (s *SetNameRequestV3Body) UnmarshalJSON(data []byte) error {
	type unmarshaler SetNameRequestV3Body
	var value unmarshaler
	if err := json.Unmarshal(data, &value); err != nil {
		return err
	}
	*s = SetNameRequestV3Body(value)

	extraProperties, err := core.ExtractExtraProperties(data, *s)
	if err != nil {
		return err
	}
	s.extraProperties = extraProperties

	s._rawJSON = json.RawMessage(data)
	return nil
}

func (s *SetNameRequestV3Body) String() string {
	if len(s._rawJSON) > 0 {
		if value, err := core.StringifyJSON(s._rawJSON); err == nil {
			return value
		}
	}
	if value, err := core.StringifyJSON(s); err == nil {
		return value
	}
	return fmt.Sprintf("%#v", s)
}

type Union struct {
	Type string
	Foo  *Foo
	Bar  *Bar
}

func NewUnionFromFoo(value *Foo) *Union {
	return &Union{Type: "foo", Foo: value}
}

func NewUnionFromBar(value *Bar) *Union {
	return &Union{Type: "bar", Bar: value}
}

func (u *Union) UnmarshalJSON(data []byte) error {
	var unmarshaler struct {
		Type string `json:"type"`
	}
	if err := json.Unmarshal(data, &unmarshaler); err != nil {
		return err
	}
	u.Type = unmarshaler.Type
	switch unmarshaler.Type {
	case "foo":
		value := new(Foo)
		if err := json.Unmarshal(data, &value); err != nil {
			return err
		}
		u.Foo = value
	case "bar":
		value := new(Bar)
		if err := json.Unmarshal(data, &value); err != nil {
			return err
		}
		u.Bar = value
	}
	return nil
}

func (u Union) MarshalJSON() ([]byte, error) {
	switch u.Type {
	default:
		return nil, fmt.Errorf("invalid type %s in %T", u.Type, u)
	case "foo":
		return core.MarshalJSONWithExtraProperty(u.Foo, "type", "foo")
	case "bar":
		return core.MarshalJSONWithExtraProperty(u.Bar, "type", "bar")
	}
}

type UnionVisitor interface {
	VisitFoo(*Foo) error
	VisitBar(*Bar) error
}

func (u *Union) Accept(visitor UnionVisitor) error {
	switch u.Type {
	default:
		return fmt.Errorf("invalid type %s in %T", u.Type, u)
	case "foo":
		return visitor.VisitFoo(u.Foo)
	case "bar":
		return visitor.VisitBar(u.Bar)
	}
}

type UpdateRequest struct {
	Tag              string     `json:"-" url:"tag"`
	Extra            *string    `json:"-" url:"extra,omitempty"`
	Union            *Union     `json:"union,omitempty" url:"-"`
	Filter           *Filter    `json:"filter,omitempty" url:"-"`
	OptionalUnion    *Union     `json:"optionalUnion,omitempty" url:"-"`
	OptionalFilter   *Filter    `json:"optionalFilter,omitempty" url:"-"`
	OptionalDate     *time.Time `json:"optionalDate,omitempty" url:"-" format:"date"`
	OptionalDatetime *time.Time `json:"optionalDatetime,omitempty" url:"-"`
}

func (u *UpdateRequest) UnmarshalJSON(data []byte) error {
	type unmarshaler UpdateRequest
	var body unmarshaler
	if err := json.Unmarshal(data, &body); err != nil {
		return err
	}
	*u = UpdateRequest(body)
	return nil
}

func (u *UpdateRequest) MarshalJSON() ([]byte, error) {
	type embed UpdateRequest
	var marshaler = struct {
		embed
		OptionalDate     *core.Date     `json:"optionalDate,omitempty"`
		OptionalDatetime *core.DateTime `json:"optionalDatetime,omitempty"`
	}{
		embed:            embed(*u),
		OptionalDate:     core.NewOptionalDate(u.OptionalDate),
		OptionalDatetime: core.NewOptionalDateTime(u.OptionalDatetime),
	}
	return json.Marshal(marshaler)
}
