import { z } from "zod";
import { CustomReadmeSectionSchema } from "./CustomReadmeSectionSchema";

// The full set of configuration options supported by the TypeScript SDK generator.
export const TypescriptCustomConfigSchema = z.strictObject({
    neverThrowErrors: z.optional(z.boolean()),
    outputEsm: z.optional(z.boolean()),
    outputSourceFiles: z.optional(z.boolean()),
    includeCredentialsOnCrossOriginRequests: z.optional(z.boolean()),
    bundle: z.optional(z.boolean()),
    allowCustomFetcher: z.optional(z.boolean()),
    shouldGenerateWebsocketClients: z.optional(z.boolean()),
    defaultTimeoutInSeconds: z.optional(z.union([z.literal("infinity"), z.number()])),
    skipResponseValidation: z.optional(z.boolean()),
    extraDependencies: z.optional(z.record(z.string())),
    extraDevDependencies: z.optional(z.record(z.string())),
    extraPeerDependencies: z.optional(z.record(z.string())),
    extraPeerDependenciesMeta: z.optional(z.record(z.any())),
    treatUnknownAsAny: z.optional(z.boolean()),
    noOptionalProperties: z.optional(z.boolean()),
    tolerateRepublish: z.optional(z.boolean()),
    packageJson: z.optional(z.record(z.any())),
    publishToJsr: z.optional(z.boolean()),
    omitUndefined: z.optional(z.boolean()),
    useLegacyExports: z.optional(z.boolean()),
    streamType: z.optional(z.enum(["wrapper", "web"])),
    fileResponseType: z.optional(z.enum(["stream", "binary-response"])),
    formDataSupport: z.optional(z.enum(["Node16", "Node18"])),
    fetchSupport: z.optional(z.enum(["node-fetch", "native"])),
    packagePath: z.optional(z.string()),
    omitFernHeaders: z.optional(z.boolean()),
    useDefaultRequestParameterValues: z.optional(z.boolean()),
    packageManager: z.optional(z.enum(["pnpm", "yarn"])),
    flattenRequestParameters: z.optional(z.boolean()),
    exportAllRequestsAtRoot: z.optional(z.boolean()),
    customReadmeSections: z.optional(z.array(CustomReadmeSectionSchema)),
    testFramework: z.optional(z.enum(["jest", "vitest"])),
    consolidateTypeFiles: z.optional(z.boolean()),
    generateEndpointMetadata: z.optional(z.boolean()),
    wireTestsFallbackToAutoGeneratedErrorExamples: z.boolean().optional(),
    linter: z.optional(z.enum(["biome", "oxlint", "none"])),
    formatter: z.optional(z.enum(["prettier", "biome", "oxfmt"])),
    enableForwardCompatibleEnums: z.optional(z.boolean()),
    parameterNaming: z.optional(z.enum(["originalName", "wireValue", "camelCase", "snakeCase", "default"])),
    generateSubpackageExports: z.optional(z.boolean()),
    clientClassName: z.optional(z.string()),
    exportedClientClassName: z.optional(z.string()),

    // relevant to dynamic snippets
    allowExtraFields: z.optional(z.boolean()),
    enableInlineTypes: z.optional(z.boolean()),
    inlineFileProperties: z.optional(z.boolean()),
    inlinePathParameters: z.optional(z.boolean()),
    namespaceExport: z.optional(z.string()),
    noSerdeLayer: z.optional(z.boolean()),
    private: z.optional(z.boolean()),
    requireDefaultEnvironment: z.optional(z.boolean()),
    retainOriginalCasing: z.optional(z.boolean()),
    useBigInt: z.optional(z.boolean()),
    useBrandedStringAliases: z.optional(z.boolean()),
    offsetSemantics: z.optional(z.enum(["item-index", "page-index"])),

    // beta (not in docs)
    includeContentHeadersOnFileDownloadResponse: z.optional(z.boolean()),
    includeUtilsOnUnionMembers: z.optional(z.boolean()),
    includeOtherInUnionTypes: z.optional(z.boolean()),
    generateWireTests: z.optional(z.boolean()),
    noScripts: z.optional(z.boolean()),
    experimentalGenerateReadWriteOnlyTypes: z.optional(z.boolean()),

    // deprecated
    timeoutInSeconds: z.optional(z.union([z.literal("infinity"), z.number()])),
    includeApiReference: z.optional(z.boolean()),

    // internal - license name extracted from custom license file
    _fernLicenseName: z.optional(z.string())
});

export type TypescriptCustomConfigSchema = z.infer<typeof TypescriptCustomConfigSchema>;
