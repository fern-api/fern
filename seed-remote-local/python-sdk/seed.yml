displayName: Python SDK (Remote vs Local)
irVersion: v61
image: fernapi/fern-python-sdk
changelogLocation: ../../generators/python/sdk/versions.yml

test:
  local:
    workingDirectory: generators/python
    buildCommand:
      - chmod +x setup-python.sh && ./setup-python.sh
      - poetry config virtualenvs.in-project true
      - poetry install
    runCommand: poetry run python -m src.fern_python.generators.sdk.cli {CONFIG_PATH}
    env:
      PYTEST_CURRENT_TEST: "some value"

language: python
generatorType: SDK
defaultOutputMode: github

# Remote vs Local testing with GitHub PR output
# Uses ephemeral GitHub repos injected by test runner
fixtures:
  imdb:
    # Remote generation (uses Fiddle cloud service)
    - outputFolder: remote
      customConfig: null
      publishConfig:
        type: pypi
        packageName: "fern-test-imdb-sdk"
        token: ""
      github:
        repository: ${GITHUB_TEST_REPO}
        mode: pull-request

    # Local generation (uses Docker)
    - outputFolder: local
      customConfig: null
      publishConfig:
        type: pypi
        packageName: "fern-test-imdb-sdk"
        token: ""
      github:
        uri: ${GITHUB_TEST_REPO}
        token: ${GITHUB_TOKEN}
        mode: pull-request
