imports:
  commons: commons.yml

types:
  Post:
    docs: A blog post
    properties:
      id: commons.PostId
      type: PostType
      title: string
      author: Author
      content: string
      relatedPosts: list<Post>

  CreatePostRequest:
    properties:
      type: PostType
      title: string
      author: Author
      content: string

  PostType:
    enum:
      - LONG
      - SHORT

  Author:
    union:
      anonymous: {}
      named: string

  PostNotFoundErrorBody:
    properties:
      id: commons.PostId

errors:
  PostNotFoundError:
    status-code: 404
    type: PostNotFoundErrorBody

services:
  http:
    PostsService:
      base-path: /posts
      auth: true
      headers:
        X-Service-Header: string
      endpoints:
        createPost:
          method: POST
          path: /
          auth: false
          headers:
            X-Endpoint-Header: string
          request: CreatePostRequest
          response: commons.PostId
        getPost:
          method: GET
          path: /{postId}
          path-parameters:
            postId: commons.PostId
          query-parameters:
            page: optional<integer>
            otherParam: integer
          response: Post
          errors:
            - PostNotFoundError
        getPostV2:
          method: GET
          path: /get
          request: commons.PostId
          response: Post
          errors:
            - PostNotFoundError
        deletePost:
          method: DELETE
          path: /{postId}
          path-parameters:
            postId: commons.PostId
        noopWithAuth:
          method: GET
          path: /
        noopWithoutAuth:
          method: GET
          auth: false
          path: /
