imports:
  director: director.yml
types:
  MovieId:
    type: string
    examples:
      - id1
      - id2
  ActorId: string
  Movie:
    properties:
      id: MovieId
      title: string
      rating: double
    examples:
      - id: my-movie-id
        title: Goodwill Hunting
        rating: 14.5
  CreateMovieRequest:
    properties:
      title: string
      ratings: list<double>
  Person:
    union:
      actor: ActorId
      director: director.Director
      producer: {}
    examples:
      - type: actor
        value: Matt Damon
      - type: director
        name: George the Directory
        age: 100
      - type: producer
  RecursiveType:
    extends: CreateMovieRequest
    properties:
      selfReferencing: list<RecursiveType>
    examples:
      - title: The Godfather
        ratings: [10, 5, 9]
        selfReferencing:
          - title: The Godfather II
            ratings: [10, 11]
            selfReferencing: []
          - title: The Godfather III
            ratings: []
            selfReferencing: []
      - title: Goodfellas
        ratings: [1, 2, 3]
        selfReferencing: []
errors:
  NotFoundError:
    status-code: 404
    type: string
services:
  http:
    MoviesService:
      auth: false
      base-path: /movies
      endpoints:
        createMovie:
          method: POST
          path: /
          request: CreateMovieRequest
          response: MovieId
          audiences:
            - test
        getMovie:
          method: GET
          path: /{movieId}
          request:
            name: GetMovieRequest
            path-parameters:
              movieId: MovieId
            query-parameters:
              movieName:
                type: string
                allow-multiple: true
          response: Movie
          errors:
            - NotFoundError
        delete:
          method: DELETE
          path: /{movieId}
          request:
            path-parameters:
              movieId: MovieId
