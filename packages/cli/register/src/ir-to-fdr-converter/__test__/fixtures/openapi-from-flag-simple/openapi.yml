openapi: 3.0.3
info:
  title: Simple OpenAPI Test
  version: 1.0.0
  description: A simple OpenAPI spec for testing the --from-openapi flag functionality

servers:
  - url: https://api.example.com/v1
    description: Production server

paths:
  /health:
    get:
      operationId: getHealth
      summary: Health check endpoint
      description: Returns the health status of the service
      responses:
        "200":
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
        "503":
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /users/{userId}:
    get:
      operationId: getUser
      summary: Get user by ID
      description: Retrieves a user by their unique identifier
      parameters:
        - name: userId
          in: path
          required: true
          description: The unique identifier of the user
          schema:
            type: string
            example: "user123"
        - name: includeMetadata
          in: query
          required: false
          description: Whether to include user metadata
          schema:
            type: boolean
            default: false
      responses:
        "200":
          description: User found successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /users:
    post:
      operationId: createUser
      summary: Create a new user
      description: Creates a new user with the provided information
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateUserRequest"
      responses:
        "201":
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid user data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
      properties:
        status:
          type: string
          enum: [healthy, degraded]
          description: The current health status
        timestamp:
          type: string
          format: date-time
          description: When the health check was performed
        version:
          type: string
          description: Service version
          example: "1.0.0"

    User:
      type: object
      required:
        - id
        - email
        - createdAt
      properties:
        id:
          type: string
          description: Unique user identifier
          example: "user123"
        email:
          type: string
          format: email
          description: User's email address
          example: "user@example.com"
        firstName:
          type: string
          description: User's first name
          example: "John"
        lastName:
          type: string
          description: User's last name
          example: "Doe"
        createdAt:
          type: string
          format: date-time
          description: When the user was created
        metadata:
          type: object
          description: Additional user metadata
          additionalProperties: true

    CreateUserRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          description: User's email address
          example: "newuser@example.com"
        firstName:
          type: string
          description: User's first name
          example: "Jane"
        lastName:
          type: string
          description: User's last name
          example: "Smith"
        metadata:
          type: object
          description: Additional user metadata
          additionalProperties: true

    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          example: "USER_NOT_FOUND"
        message:
          type: string
          description: Human-readable error message
          example: "The requested user could not be found"
        details:
          type: object
          description: Additional error details
          additionalProperties: true
