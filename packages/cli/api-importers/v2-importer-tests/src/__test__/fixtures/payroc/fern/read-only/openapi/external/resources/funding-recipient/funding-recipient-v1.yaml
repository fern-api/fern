openapi: 3.0.3

info:
  title: Account Boarding API
  description: Create and manage funding recipients.
  version: '1'
  termsOfService: https://www.payroc.com/terms
  contact:
    name: Payroc Helpdesk
    url: https://www.payroc.com/help
    email: helpdesk@payroc.com

servers:
  - url: https://api.payroc.com/v1
    description: Production
  - url: https://api.uat.payroc.com/v1
    description: UAT

security:
- bearerAuth: []

tags:
  - name: Funding recipients
    description: Entities that can receive funds but that can't take payments.

paths:
  /funding-recipients:
    summary: Create and manage funding recipients.
    post:
      tags:
      - Funding recipients
      summary: Create funding recipient
      description: Create a funding recipient.
      operationId: createFundingRecipient
      parameters:
        - $ref: '../../../common/parameters/idempotency-key-v1.yaml#/components/parameters/idempotencyKey'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/createFundingRecipient'
      responses:
        '201':
          description: Successful request. We created the funding recipient.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/fundingRecipient'
          headers:
            location:
              $ref: '../../../common/headers/location-v1.yaml#/components/headers/location'
        '400':
          description: Validation errors
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples:
                idempotentKeyMissing:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/idempotentKeyMissing'
                validationError:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/validatorError'
                kycCheckFailed:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/kycCheckFailed' 
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/409-v1.yaml#/components/schemas/409'
              examples:
                idempotentKeyInUse:
                  $ref: '../../../common/responses/errors/409-v1.yaml#/components/examples/idempotentKeyInUse'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
    get:
      tags:
      - Funding recipients
      summary: List funding recipients
      description: Retrieve a list of all funding recipients associated with the ISV.
      operationId: listFundingRecipients
      parameters:
        - $ref: '../../../common/parameters/before-v1.yaml#/components/parameters/before'
        - $ref: '../../../common/parameters/after-v1.yaml#/components/parameters/after'
        - $ref: '../../../common/parameters/limit-v1.yaml#/components/parameters/limit'
      responses:
        '200':
          description: Successful request. Returns a paginated list of all funding recipients.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/paginatedFundRecipients'
              examples:
                paginatedFundingRecipients:
                  $ref: './example-responses-v1.yaml#/components/examples/paginatedFundRecipients'
                noActivity:
                  $ref: '../../../common/responses/no-activity-v1.yaml#/components/examples/noActivity'
        '400':
          $ref: '../../../common/responses/errors/400-v1.yaml#/components/responses/400'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
  /funding-recipients/{recipientId}:
    get:
      tags:
      - Funding recipients
      summary: Retrieve a funding recipient
      description: Retrieve a specific funding recipient.
      operationId: getFundingRecipient
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      responses:
        '200':
          description: Successful request. Returns the requested funding recipient.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/fundingRecipient'
              examples:
                fundingRecipient:
                  $ref: './example-responses-v1.yaml#/components/examples/fundingRecipient'
        '400':
          $ref: '../../../common/responses/errors/400-v1.yaml#/components/responses/400'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
    put:
      tags:
      - Funding recipients
      summary: Update funding recipient
      description: Update a funding recipient. If you make significant changes, we may need to approve the funding recipient again. 
      operationId: updateFundingRecipient
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/fundingRecipient'
      responses:
        '204':
          description: Successful request. We updated the funding recipient. 
        '400':
          description: Validation errors
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples:
                validationError:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/validatorError'
                kycCheckFailed:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/kycCheckFailed'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
    delete:
      tags:
      - Funding recipients
      summary: Delete funding recipient
      description: Delete a funding recipient. This includes funding accounts and owners linked to the funding recipient.
      operationId: deleteFundingRecipient
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      responses:
        '204':
          description: Successful request. We deleted the funding recipient.
        '400':
          $ref: '../../../common/responses/errors/400-v1.yaml#/components/responses/400'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
  /funding-recipients/{recipientId}/funding-accounts:
    get:
      tags:
      - Funding recipients
      summary: List funding accounts
      description: Retrieve all funding accounts associated with the funding recipient.
      operationId: listFundRecipientFundingAccounts
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      responses:
        '200':
          description: Successful request. Returns a list of all funding accounts associated with the funding recipient.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '../../../common/schemas/boarding/funding-account-v1.yaml#/components/schemas/fundingAccount'
              examples:
                fundingAccounts: 
                  $ref: './example-responses-v1.yaml#/components/examples/fundingAccounts'
        '400':
          $ref: '../../../common/responses/errors/400-v1.yaml#/components/responses/400'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
    post:
      tags:
      - Funding recipients
      summary: Create funding account
      description: Create a new funding account, and add it to the funding recipient.
      operationId: createFundRecipientFundingAccount
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      - $ref: '../../../common/parameters/idempotency-key-v1.yaml#/components/parameters/idempotencyKey'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '../../../common/schemas/boarding/funding-account-v1.yaml#/components/schemas/fundingAccount'
      responses:
        '201':
          description: Successful request. We created the funding account and added it to the funding recipient.
          content:
            application/json:
              schema:
                $ref: '../../../common/schemas/boarding/funding-account-v1.yaml#/components/schemas/fundingAccount'
              examples:
                fundingAccount: 
                  $ref: './example-responses-v1.yaml#/components/examples/fundingAccount'  
          headers:
            location:
              $ref: '../../../common/headers/location-v1.yaml#/components/headers/location'
        '400':
          description: Validation errors
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples:
                idempotentKeyMissing:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/idempotentKeyMissing'
                validationError:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/validatorError'
                kycCheckFailed:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/kycCheckFailed'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/409-v1.yaml#/components/schemas/409'
              examples:
                idempotentKeyInUse:
                  $ref: '../../../common/responses/errors/409-v1.yaml#/components/examples/idempotentKeyInUse'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'
  /funding-recipients/{recipientId}/owners:
    get:
      tags:
      - Funding recipients
      summary: List funding recipient owners
      description: Retrieve all owners associated with the funding recipient.
      operationId: listFundRecipientOwners
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      responses:
        '200':
          description: Successful request. Returns a list of all owners associated with the funding recipient.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '../../../common/schemas/boarding/owner-v1.yaml#/components/schemas/owner'
        '400':
          $ref: '../../../common/responses/errors/400-v1.yaml#/components/responses/400'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500' 
    post:
      tags:
      - Funding recipients
      summary: Create funding recipient owner
      description: Create a new owner, and add it to the funding recipient.
      operationId: createFundRecipientOwner
      parameters:
      - $ref: './parameters-v1.yaml#/components/parameters/recipientId'
      - $ref: '../../../common/parameters/idempotency-key-v1.yaml#/components/parameters/idempotencyKey'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '../../../common/schemas/boarding/owner-v1.yaml#/components/schemas/owner'
      responses:
        '201':
          description: Successful request. We created the owner and added it to the funding recipient.
          content:
            application/json:
              schema:
                $ref: '../../../common/schemas/boarding/owner-v1.yaml#/components/schemas/owner'
          headers:
            location:
              $ref: '../../../common/headers/location-v1.yaml#/components/headers/location'
        '400':
          description: Validation errors
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples:
                idempotentKeyMissing:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/idempotentKeyMissing'
                validationError:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/validatorError'
                kycCheckFailed:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/kycCheckFailed'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/409-v1.yaml#/components/schemas/409'
              examples:
                idempotentKeyInUse:
                  $ref: '../../../common/responses/errors/409-v1.yaml#/components/examples/idempotentKeyInUse'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'

components:
  schemas:
    createFundingRecipient:
      required:
        - address
        - contactMethods
        - recipientType
        - taxId
        - owners
        - fundingAccounts
        - doingBuinessAs
      type: object
      title: create funding recipient
      properties:
        recipientId:
          type: integer
          readOnly: true
          example: 1
        status:
          type: string
          readOnly: true
          enum:
            - approved
            - rejected
            - pending
          example: approved
        createdDate:
          type: string
          format: date-time
          example: '2024-07-02T15:30:00Z'
          readOnly: true
        lastModifiedDate:
          type: string
          format: date-time
          example: '2024-07-02T15:30:00Z'
          readOnly: true
        recipientType:
          type: string
          description: Type or legal structure of the funding recipient.
          example: privateCorporation
          enum:
            - privateCorporation
            - publicCorporation
            - nonProfit
            - government
            - privateLlc
            - publicLlc
            - privatePartnership
            - publicPartnership
            - soleProprietor
        taxId:
          type: string
          description: Employer identification number (EIN) or Social Security number (SSN).
          example: '12-3456789'
        charityId:
          type: string
          description: Government identifier of the charity.
        doingBusinessAs:
          type: string
          description: Legal name that the business operates under.
        address:
          type: object
          description: Address of the funding recipient.
          oneOf:
            - $ref: '../../../common/schemas/common/address-v1.yaml#/components/schemas/address'
        contactMethods:
          type: array
          minItems: 1
          xml:
            wrapped: true
          description: Array of contactMethod objects that you can use to add contact methods for the funding recipient. You must provide at least an email address. 
          items:
            $ref: '../../../common/schemas/common/contact-method-v1.yaml#/components/schemas/contactMethod'
          example:
          - type: email
            value: jane.doe@example.com
        metadata:
          type: object
          additionalProperties:
            type: string
          description: '[Metadata](/api/metadata) object you can use to include custom data with your request.'
          example:
            yourCustomField: abc123
        owners:
          minItems: 1
          description: Array of owner objects that you can use to add owners to the funding recipient.
          type: array
          xml:
            wrapped: true
          items:
            xml:
              name: owners
            $ref: '../../../common/schemas/boarding/owner-v1.yaml#/components/schemas/owner'
        fundingAccounts:
          minItems: 1
          description: Array of fundingAccount objects that you can use to add funding accounts to the funding recipient.
          type: array
          xml:
            wrapped: true
          items:
            xml:
              name: fundingAccount
            $ref: '../../../common/schemas/boarding/funding-account-v1.yaml#/components/schemas/fundingAccount'

    fundingRecipient:
      required:
        - address
        - contactMethods
        - recipientType
        - taxId
        - owners
        - fundingAccounts
        - doingBuinessAs
      type: object
      title: funding recipient
      properties:
        recipientId:
          type: integer
          description: Unique identifier of the funding recipient.
          readOnly: true
          example: 234
        status:
          type: string
          description: Indicates if we have approved the funding recipient.
          readOnly: true
          enum:
            - approved
            - rejected
            - pending
          example: approved
        createdDate:
          type: string
          description: Date the funding recipient was created.
          format: date-time
          example: '2024-07-02T15:30:00Z'
          readOnly: true
        lastModifiedDate:
          type: string
          description: Date the funding recipient was last modified.
          format: date-time
          example: '2024-07-02T15:30:00Z'
          readOnly: true
        recipientType:
          type: string
          enum:
            - privateCorporation
            - publicCorporation
            - nonProfit
            - government
            - privateLlc
            - publicLlc
            - privatePartnership
            - publicPartnership
            - soleProprietor
          example: privateCorporation
          description: Type or legal structure of the funding recipient. 
        taxId:
          type: string
          description: Employer identification number (EIN) or Social Security number (SSN). 
          example: '12-3456789'
        charityId:
          type: string
          description: Government identifier of the charity. 
        doingBuinessAs:
          type: string
          description: Legal name that the business operates under.
        address:
          type: object
          description: Address of the funding recipient.
          oneOf:
            - $ref: '../../../common/schemas/common/address-v1.yaml#/components/schemas/address'
        contactMethods:
          type: array
          minItems: 1
          xml:
            wrapped: true
          description: Array of contactMethod objects for the funding recipient.  
          items:
            $ref: '../../../common/schemas/common/contact-method-v1.yaml#/components/schemas/contactMethod'
          example:
            - type: email
              value: jane.doe@example.com
        metadata:
          type: object
          additionalProperties:
            type: string
          description: '[Metadata](/api/metadata) object you can use to include custom data with your request.'
          example:
            yourCustomField: abc123
        owners:
          readOnly: true
          description: Array of owner objects associated with the funding recipient.
          type: array
          xml:
            wrapped: true
          items:
            type: object
            title: owner summary
            xml: 
              name: owner
            properties:
              ownerId:
                type: integer
                description: Unique identifier of the owner.
                example: 4564
              link:
                type: object
                description: Array of HATEOAS links for viewing the owner.
                properties:
                  rel:
                    type: string
                    example: owner
                  href:
                    type: string
                    example: https://api.payroc.com/v1/owners/4564
                  method:
                    type: string
                    example: get
        fundingAccounts:
          readOnly: true
          description: Array of fundingAccount objects associated with the funding recipient.
          type: array
          xml:
            wrapped: true
          items:
            type: object
            title: funding account summary
            xml: 
              name: funding account
            properties:
              fundingAccountId:
                type: integer
                description: Unique identifier of the funding account.
                example: 123
              status:
                type: string
                description: Status of the funding account.
                enum:
                  - approved
                  - rejected
                  - pending
                  - hold
                example: pending
              link:
                type: object
                description: HATEOAS links for viewing the funding account.
                properties:
                  rel:
                    type: string
                    example: fundingAccount
                  href:
                    type: string
                    example: https://api.payroc.com/v1/funding-accounts/123
                  method:
                    type: string
                    example: get
          example:
            - fundingAccountId: 123
              status: approved
              link:
                rel:  fundingAccount
                href: https://api.payroc.com/v1/funding-accounts/123
                method: get  
            - fundingAccountId: 124
              status: rejected
              link:
                rel:  fundingAccount
                href: https://api.payroc.com/v1/funding-accounts/124
                method: get 
    
    paginatedFundRecipients:
      type: object
      title: paginated funding recipients
      allOf:
        - $ref: '../../../common/schemas/common/paginated-list-v1.yaml#/components/schemas/paginatedList'
        - type: object
          properties:
            data:
              type: array
              description: An array of funding recipients
              items:
                $ref: '#/components/schemas/fundingRecipient'

  securitySchemes:
    bearerAuth:
      $ref: '../../../common/security/bearer-auth.yaml#/components/securitySchemes/bearerAuth'
