openapi: 3.0.1
info:
  title: Transaction API
  version: '1'
  termsOfService: https://www.payroc.com/terms
  contact:
    name: Payroc Helpdesk
    url: https://www.payroc.com/help
    email: helpdesk@payroc.com
servers:
  - url: https://api.payroc.com/v1
    description: Production
  - url: https://api.uat.payroc.com/v1
    description: UAT
tags:
- name: Bank accounts

paths:
  /bank-accounts/verify:
    post:
      tags:
        - Bank accounts
      summary: Verify a bank account
      operationId: verifyBankAccount
      description: Verify the customer's bank account details.
      parameters:
        - $ref: ../../../common/parameters/idempotency-key-v1.yaml#/components/parameters/idempotencyKey
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/bankAccountVerificationRequest"
            examples:
              bankAccountVerificationRequestPad:
                $ref: './example-requests-v1.yaml#/components/examples/bankAccountVerificationRequestPad'
              bankAccountVerificationRequestAch:
                $ref: './example-requests-v1.yaml#/components/examples/bankAccountVerificationRequestAch'
        required: true
      responses:
        '200':
          description: Successful request. Returns the verification status of the customer's bank account details.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/bankAccountVerificationResult"
              examples:
                bankAccountVerificationResponse:
                  $ref: './example-responses-v1.yaml#/components/examples/bankAccountVerificationResponse'
        '400':
          description: Validation error
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples:
                validationError:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/validatorError'
                idempotentKeyMissing:
                  $ref: '../../../common/responses/errors/400-v1.yaml#/components/examples/idempotentKeyMissing'
                idempotentKeyInUse:
                  $ref: '../../../common/responses/errors/409-v1.yaml#/components/examples/idempotentKeyInUse'
        '401':
          $ref: ../../../common/responses/errors/401-v1.yaml#/components/responses/401
        '403':
          $ref: ../../../common/responses/errors/403-v1.yaml#/components/responses/403
        '404':
          $ref: ../../../common/responses/errors/404-v1.yaml#/components/responses/404
        '406':
          $ref: ../../../common/responses/errors/406-v1.yaml#/components/responses/406
        '409':
          $ref: ../../../common/responses/errors/409-v1.yaml#/components/responses/409
        '415':
          $ref: ../../../common/responses/errors/415-v1.yaml#/components/responses/415
        '500':
          $ref: ../../../common/responses/errors/500-v1.yaml#/components/responses/500

components:
  schemas:
    bankAccountVerificationRequest:
      required:
        - processingTerminalId
        - bankAccount
      type: object
      properties:
        processingTerminalId:
          maxLength: 50
          minLength: 4
          type: string
          description: Unique identifier that we assigned to the terminal.
          example: '1234001'
        bankAccount:
          description: Object that contains information about the bank account.
          type: object
          discriminator:
            propertyName: type
            mapping:
              ach: '../../../common/schemas/transaction/payment-method-v1.yaml#/components/schemas/achPayload'
              pad: '../../../common/schemas/transaction/payment-method-v1.yaml#/components/schemas/padPayload'
          oneOf:
            - $ref: '../../../common/schemas/transaction/payment-method-v1.yaml#/components/schemas/achPayload'
            - $ref: '../../../common/schemas/transaction/payment-method-v1.yaml#/components/schemas/padPayload'
    bankAccountVerificationResult:
      required:
        - processingTerminalId
        - verified
      type: object
      properties:
        processingTerminalId:
          maxLength: 50
          minLength: 4
          type: string
          description: Unique identifier that we assigned to the terminal.
          example: '1234001'
        verified:
          type: boolean
          description: |
            Indicates if the customer's bank account details are valid.  
            - `true` - Account details are valid.  
            - `false` - Account details are not valid.
          example: true
