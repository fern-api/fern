openapi: 3.0.3
info:
  title: Settlement
  description: Settlement
  version: '1'
  termsOfService: https://www.payroc.com/terms
  contact:
    name: Payroc Helpdesk
    url: https://www.payroc.com/help
    email: helpdesk@payroc.com
security:
- bearerAuth: []
tags:
  - name: Settlement
    description: Settlement information.

paths:
  /batches:
    get:
      tags: [Settlement]
      summary: List batches
      description: Retrieve batch data for a specific date.
      operationId: getbatches
      parameters:
        - $ref: '../../../common/parameters/before-v1.yaml#/components/parameters/before'
        - $ref: '../../../common/parameters/after-v1.yaml#/components/parameters/after'
        - $ref: '../../../common/parameters/limit-v1.yaml#/components/parameters/limit'
        - $ref: './parameters-v1.yaml#/components/parameters/date'
        - $ref: '../../../common/parameters/merchant-id-v1.yaml#/components/parameters/merchantId'
      responses:
        '200':
          description: Successful request. Returns a paginated list of batches.
          content:
            application/json:
              schema:
                type: object
                allOf:
                - $ref: '../../../common/schemas/common/paginated-list-v1.yaml#/components/schemas/paginatedList'
                - type: object
                  properties:
                    data:
                      type: array
                      description: Array of batch objects.
                      items:
                        $ref: '#/components/schemas/batch'
                  required: [data] 
              examples:
                paginatedList:
                  $ref: './example-responses-v1.yaml#/components/examples/paginatedBatches'
                noActivity:
                  $ref: '../../../common/responses/no-activity-v1.yaml#/components/examples/noActivity'     
        '400':
          description: Validation error
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples: 
                parameterError:
                  $ref: '../../../common/responses/rfc-errors/400-v1.yaml#/components/examples/parameterError'
                paginationError:
                  $ref: '../../../common/responses/rfc-errors/400-v1.yaml#/components/examples/paginationError'
                idError:
                  $ref: './example-responses-v1.yaml#/components/examples/batchIdError'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'

  /batches/{batchId}:
    get:
      tags: [Settlement]
      summary: Retrieve batch
      description: Retrieve a specific batch.
      operationId: getbatch
      parameters:
        - $ref: '../../../common/parameters/settlement-v1.yaml#/components/parameters/batchId'
      responses:
        '200':
          description: Successful request. Returns the requested batch.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/batch'    
        '400':
          description: Validation error
          content:
            application/problem+json:
              schema:
                $ref: '../../../common/responses/errors/400-v1.yaml#/components/schemas/400'
              examples: 
                idError:
                  $ref: './example-responses-v1.yaml#/components/examples/batchIdError'
        '401':
          $ref: '../../../common/responses/errors/401-v1.yaml#/components/responses/401'
        '403':
          $ref: '../../../common/responses/errors/403-v1.yaml#/components/responses/403'
        '404':
          $ref: '../../../common/responses/errors/404-v1.yaml#/components/responses/404'
        '406':
          $ref: '../../../common/responses/errors/406-v1.yaml#/components/responses/406'
        '500':
          $ref: '../../../common/responses/errors/500-v1.yaml#/components/responses/500'

components:
  schemas:
    batch:
      type: object
      title: batch
      properties:
        batchId:
          type: integer
          description: Unique identifier of the batch.
          example: 123
        date:
          type: string
          format: date
          description: Date that the merchant submitted the batch. The format of this value is **YYYY-MM-DD**.
          example: '2024-07-02'
        createdDate:
          type: string
          format: date
          description: Date that we created a record for the batch. The format of this value is **YYYY-MM-DD**.
          example: '2024-07-02'
        lastModifiedDate:
          type: string
          format: date
          description: Date that the batch was last changed. The format of this value is **YYYY-MM-DD**.
          example: '2024-07-02'
        saleAmount:
          type: integer
          description: Total value of sales. We return the value in the currency's lowest denomination, for example, cents.
        heldAmount:
          type: integer
          description: Total value of authorizations. We return the value in the currency's lowest denomination, for example, cents.
        returnAmount:
          type: integer
          description: Total value of returns. We return the value in the currency's lowest denomination, for example, cents.
        transactionCount:
          type: integer
          description: Total number of transactions in the batch.
        currency:
          type: string
          description: Currency of the transactions.
        merchant:
          $ref: '../../../common/schemas/settlement/merchant-summary-v1.yaml#/components/schemas/merchantSummary'
        links:
          type: array
          items:
            $ref: '../../../common/schemas/common/link/link-v1.yaml#/components/schemas/link' 
          example:
          - rel: transactions
            method: get
            href: 'https://api.payroc.com/v1/transactions?batchId=123'
          - rel: authorizations
            method: get
            href: 'https://api.payroc.com/v1/authorizations?batchId=123'

  securitySchemes:
    bearerAuth:
      $ref: '../../../common/security/bearer-auth.yaml#/components/securitySchemes/bearerAuth'
