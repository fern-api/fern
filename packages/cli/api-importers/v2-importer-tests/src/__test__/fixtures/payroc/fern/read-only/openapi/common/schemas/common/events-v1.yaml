openapi: 3.0.3

paths: {}

info:
  title: Common Domain Models
  description: Common domain models that are shared across the Payroc API
  version: '1'
  contact:
    name: Payroc Helpdesk
    url: https://www.payroc.com/help
    email: helpdesk@payroc.com

tags:
  - name: Common schemas
    description: Common schemas that can be resued

components:
  schemas:
    listEvents:
      type: object
      allOf:
      - $ref: '../common/paginated-list-v1.yaml#/components/schemas/paginatedList'
      - type: object
        properties:
          data:
            type: array
            items:
              allOf:
              - $ref: '#/components/schemas/event'
              - type: object
                properties:
                  links:
                    type: array
                    items:
                      $ref: "../common/link/link-v1.yaml#/components/schemas/link"
            minItems: 0
        required: [data]
    event:
      type: object
      title: event
      properties:
        id:
          type: number
          description: The unique identifier of the event
          readOnly: true
        type:
          type: string
          description: The type of the event
        occurred:
          type: string
          format: date-time
          description: The ISO8601 compliant timestamp for when the event occurred.
        version:
          type: number
          description: The version of the event data
        data:
          type: object
          description: The event data.  You should refer to the event schema for `type` for detailed body information.
        deliveries:
          type: array
          description: An array of webhook delivery attempts.  Normally this will contain a single item, however, if failures occurred, it will contain all attempted deliveries, up to and including any successful delivery.
          items:
            $ref: "#/components/schemas/delivery"
      required: [id, type, occurred, version, data]
    delivery:
      type: object
      title: delivery
      properties:
        id:
          type: number
          description: The unique identifier of the delivery attempt
          readOnly: true
        status:
          type: string
          description: The status of the delivery attempt.  Success indicates it was delivered successfully (and received a 2xx status code).  Failed indicates it was not delivered successfully, and either timed out, or received an error code (non 2xx).  Pending indicates that a delivery is being attempted.
          enum: [success, failed, pending]
        timestamp:
          type: string
          description: The ISO8601 compliant time that the delivery attempt occurred at.
          format: date-time
        duration:
          type: string
          description: The duration of the request in milliseconds.
          format: duration
        request:
          type: object
          description: The request body that was attempted to be delivered to the webhook endpoint.
          properties:
            uri:
              type: string
              description: The uri of the endpoint
              format: uri
            headers:
              type: object
              description: A map of HTTP headers, including any signature header, that was sent to the webhook endpoint
            body:
              type: object
              description: A JSON payload of the event that was sent to the webhook endpoint
        response:
          type: object
          properties:
            statusCode:
              type: number
              description: The HTTP status code that was received from the webhook endpoint.  No status code, paired with a status of failed indicates a timeout.
            headers:
              type: object
              description: The HTTP headers that were received from the webhook endpoint.
            body:
              type: object
              description: The JSON response payload that was received from the webhook endpoint.
       