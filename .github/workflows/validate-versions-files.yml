name: Validate versions.yml files

on:
  pull_request:
  push:
    branches:
     - "dak/ci/fix-version-lint-formatting"
  workflow_dispatch:

jobs:
  validate:
    name: Validate versions.yml files
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Install validator
        run: npm install -g ajv-cli

      - name: Validate go-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/go/sdk/versions.yml --strict=false

      - name: Validate  go-model
        run: ajv validate -s fern-versions-yml.schema.json -d generators/go/model/versions.yml --strict=false

      - name: Validate  go-fiber
        run: ajv validate -s fern-versions-yml.schema.json -d generators/go/fiber/versions.yml --strict=false

      - name: Validate  typescript-mcp
        run: ajv validate -s fern-versions-yml.schema.json -d generators/typescript-mcp/model/versions.yml --strict=false

      - name: Validate  python-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/python/sdk/versions.yml --strict=false

      - name: Validate  fastapi
        run: ajv validate -s fern-versions-yml.schema.json -d generators/python/fastapi/versions.yml --strict=false

      - name: Validate  pydantic
        run: ajv validate -s fern-versions-yml.schema.json -d generators/python/pydantic/versions.yml --strict=false

      - name: Validate  ts-express
        run: ajv validate -s fern-versions-yml.schema.json -d generators/typescript/express/versions.yml --strict=false

      - name: Validate  ts-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/typescript/sdk/versions.yml --strict=false

      - name: Validate  postman
        run: ajv validate -s fern-versions-yml.schema.json -d generators/postman/versions.yml --strict=false

      - name: Validate  java-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/java/sdk/versions.yml --strict=false

      - name: Validate  java-model
        run: ajv validate -s fern-versions-yml.schema.json -d generators/java/model/versions.yml --strict=false

      - name: Validate  java-spring
        run: ajv validate -s fern-versions-yml.schema.json -d generators/java/spring/versions.yml --strict=false

      - name: Validate  php-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/php/sdk/versions.yml --strict=false

      - name: Validate  php-model
        run: ajv validate -s fern-versions-yml.schema.json -d generators/php/model/versions.yml --strict=false

      - name: Validate  openapi
        run: ajv validate -s fern-versions-yml.schema.json -d generators/openapi/versions.yml --strict=false

      - name: Validate  ruby-v2
        run: ajv validate -s fern-versions-yml.schema.json -d generators/ruby-v2/sdk/versions.yml --strict=false

      - name: Validate  csharp-sdk
        run: ajv validate -s fern-versions-yml.schema.json -d generators/csharp/sdk/versions.yml --strict=false

      - name: Validate  csharp-model
        run: ajv validate -s fern-versions-yml.schema.json -d generators/csharp/model/versions.yml --strict=false

      - name: Validate  ruby
        run: ajv validate -s fern-versions-yml.schema.json -d generators/ruby/sdk/versions.yml --strict=false

      - name: Validate  ruby-model
        run: ajv validate -s fern-versions-yml.schema.json -d generators/ruby/model/versions.yml --strict=false
